{"version":3,"sources":["webpack:///./src/theme/default/context-popup.m.css","webpack:///./src/popup/index.tsx","webpack:///./src/context-popup/index.tsx","webpack:///./src/middleware/bodyScroll.tsx","webpack:///./src/theme/default/popup.m.css","webpack:///./src/popup/popup.m.css"],"names":["module","exports"," _key","trigger","__webpack_require__","r","__webpack_exports__","d","Popup","_dojo_framework_core_middleware_dimensions__WEBPACK_IMPORTED_MODULE_0__","_dojo_framework_core_middleware_theme__WEBPACK_IMPORTED_MODULE_1__","_middleware_bodyScroll__WEBPACK_IMPORTED_MODULE_2__","_dojo_framework_core_vdom__WEBPACK_IMPORTED_MODULE_3__","_theme_default_popup_m_css__WEBPACK_IMPORTED_MODULE_4__","_popup_m_css__WEBPACK_IMPORTED_MODULE_5__","Object","dimensions","theme","bodyScroll","properties","children","factory","middleware","underlayVisible","position","x","yBottom","yTop","onClose","open","wrapperDimensions","get","bottomOfVisibleScreen","document","documentElement","scrollTop","clientHeight","topOfVisibleScreen","willFit","size","height","wrapperStyles","opacity","left","top","classes","key","variant","onclick","styles","ContextPopup","_dojo_framework_core_vdom__WEBPACK_IMPORTED_MODULE_0__","_dojo_framework_core_middleware_focus__WEBPACK_IMPORTED_MODULE_1__","_popup__WEBPACK_IMPORTED_MODULE_2__","_dojo_framework_core_middleware_icache__WEBPACK_IMPORTED_MODULE_3__","_theme_default_context_popup_m_css__WEBPACK_IMPORTED_MODULE_4__","icache","focus","getOrSet","y","content","close","set","oncontextmenu","event","onOpen","preventDefault","pageX","pageY","shouldFocus","_dojo_framework_shim_global__WEBPACK_IMPORTED_MODULE_1__","destroy","bodyStyle","body","style","disabled","previousOverflow","undefined","enableScroll","setProperty","removeProperty","enable","getPropertyValue","root","underlay"],"mappings":";;;;;;;;iJACAA,EAAAC,QAAA,CAAkBC,QAAA,8BAAAC,QAAA,oECDlBC,EAAAC,EAAAC,GAAAF,EAAAG,EAAAD,EAAA,0BAAAE,IAAA,IAAAC,EAAAL,EAAA,IAAAM,EAAAN,EAAA,IAAAO,EAAAP,EAAA,IAAAQ,EAAAR,EAAA,GAAAS,EAAAT,EAAA,IAAAU,EAAAV,EAAA,IA8BA,MAIaI,EAJGO,OAAAH,EAAA,EAAAG,CAAO,CAAEC,WAAAP,EAAA,EAAYQ,MAAAP,EAAA,EAAOQ,WAAAP,EAAA,IAC1CQ,aACAC,UAEmBC,CAAQ,UAASF,WACrCA,EAAUC,SACVA,EACAE,YAAYN,WAAEA,EAAUC,MAAEA,EAAKC,WAAEA,KAEjC,MAAMK,gBACLA,GAAkB,EAAKC,SACvBA,EAAW,QAAOC,EAClBA,EAACC,QACDA,EAAOC,KACPA,EAAIC,QACJA,EAAOC,KACPA,GACGV,IAEEW,EAAoBd,EAAWe,IAAI,WACnCC,EACLC,SAASC,gBAAgBC,UAAYF,SAASC,gBAAgBE,aACzDC,EAAqBJ,SAASC,gBAAgBC,UAE9CG,EACEX,EAAOG,EAAkBS,KAAKC,QAAUR,EAD1CM,EAEEZ,EAAUI,EAAkBS,KAAKC,QAAUH,EAGnD,IAAII,EAA8C,CACjDC,QAAS,KAGNZ,EAAkBS,KAAKC,SAC1BC,EAAgB,CACfE,QAASlB,MACTiB,QAAS,KAGO,UAAblB,EAEFiB,EAAcG,IADXN,KACoBX,SAEAD,EAAUI,EAAkBS,KAAKC,WAElC,UAAbhB,IAETiB,EAAcG,IADXN,KACoBZ,EAAUI,EAAkBS,KAAKC,cAEjCb,QAK1B,MAAMkB,EAAU5B,EAAM4B,QAAQhC,GAI9B,OAFAK,GAAYW,GAGXA,GACCd,OAAAH,EAAA,EADO,CACP,YACCG,OAAAH,EAAA,EAAAG,CAAA,OACC+B,IAAI,WACJD,QAAS,CACR5B,EAAM8B,UACNjC,EAAA,SACAS,GAAmBsB,EAAQtB,iBAE5ByB,QAASpB,IAEVb,OAAAH,EAAA,EAAAG,CAAA,OACC+B,IAAI,UACJD,QAAS,CAAC5B,EAAM8B,UAAWjC,EAAA,MAC3BmC,OAAQR,GAEPrB,QAOSd,EAAA,2CChHfF,EAAAC,EAAAC,GAAAF,EAAAG,EAAAD,EAAA,iCAAA4C,IAAA,IAAAC,EAAA/C,EAAA,GAAAgD,EAAAhD,EAAA,IAAAiD,EAAAjD,EAAA,IAAAkD,EAAAlD,EAAA,IAAAmD,EAAAnD,EAAA,KAwBA,MAAMoD,EAASzC,OAAAuC,EAAA,EAAAvC,GAETM,EAAUN,OAAAoC,EAAA,EAAApC,CAAO,CAAEyC,SAAQC,MAAAL,EAAA,IAC/BjC,aACAC,WAKW8B,EAAe7B,EAAQ,UAASF,WAC5CA,EAAUC,SACVA,EACAE,YAAYkC,OAAEA,EAAMC,MAAEA,KAEtB,MAAMhC,EAAI+B,EAAOE,SAAS,IAAK,GACzBC,EAAIH,EAAOE,SAAS,IAAK,IAEzBvD,QAAEA,EAAOyD,QAAEA,GAAYxC,IAAW,GAClCyC,EAAQ,KACb,MAAMjC,QAAEA,GAAYT,IACpBqC,EAAOM,IAAI,QAAQ,GACnBlC,GAAWA,KAGZ,OACCb,OAAAoC,EAAA,EADM,CACN,eACCpC,OAAAoC,EAAA,EAAApC,CAAA,OACC8B,QAASU,EAAA,QACTT,IAAI,UACJiB,cAAgBC,IACf,MAAMC,OAAEA,GAAW9C,IACnB6C,EAAME,iBACNT,EAAMA,QACND,EAAOM,IAAI,IAAKE,EAAMG,MA3BP,GA4BfX,EAAOM,IAAI,IAAKE,EAAMI,MA3BN,GA4BhBZ,EAAOM,IAAI,QAAQ,GACnBG,GAAUA,MAGV9D,GAEFY,OAAAoC,EAAA,EAAApC,CAACsC,EAAA,QAAK,CACLP,IAAI,QACJrB,EAAGA,EACHE,KAAMgC,EACNjC,QAASO,SAASC,gBAAgBC,UAAYF,SAASC,gBAAgBE,aACvER,QAASiC,EACTrC,SAAS,QACTK,KAAM2B,EAAOzB,IAAI,SAEjBhB,OAAAoC,EAAA,EAAApC,CAAA,WAAM6C,EAAQ,CAAEC,QAAOQ,YAAaZ,EAAMY,mBAM/B/D,EAAA,2CChFfF,EAAAG,EAAAD,EAAA,sBAAAY,IAAA,IAAAiC,EAAA/C,EAAA,GAAAkE,EAAAlE,EAAA,GAGA,MAAMiB,EAAUN,OAAAoC,EAAA,EAAApC,CAAO,CAAEwD,QAAApB,EAAA,IACnBqB,EAAYF,EAAA,EAAOrC,SAASwC,KAAKC,MAE1BxD,EAAaG,EAAQ,UAAsBC,YAAYiD,QAAEA,KACrE,IAAII,GAAW,EACXC,OAAuCC,EAE3C,MAAMC,EAAe,KACfH,IAIDC,EACHJ,EAAUO,YAAY,WAAYH,GAElCJ,EAAUQ,eAAe,YAE1BL,GAAW,EACXC,OAAmBC,IAiBpB,OAJAN,EAAQ,KACPI,GAAYG,MAGLG,IACPA,EAASH,IAdLH,IAIJA,GAAW,EACXC,EAAmBJ,EAAUU,iBAAiB,YAC9CV,EAAUO,YAAY,WAAY,cAYrBzE,EAAA,wBC1CfN,EAAAC,QAAA,CAAkBC,QAAA,sBAAAqB,gBAAA,uDCAlBvB,EAAAC,QAAA,CAAkBC,QAAA,sBAAAiF,KAAA,uBAAAC,SAAA","file":"32-7.0.0-pre.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"@dojo/widgets/context-popup\",\"trigger\":\"context-popup-m__trigger__3A_JZ\"};","import { dimensions } from '@dojo/framework/core/middleware/dimensions';\nimport { theme } from '@dojo/framework/core/middleware/theme';\nimport { bodyScroll } from '../middleware/bodyScroll';\nimport { create, tsx } from '@dojo/framework/core/vdom';\nimport * as css from '../theme/default/popup.m.css';\nimport * as fixedCss from './popup.m.css';\nimport { RenderResult } from '@dojo/framework/core/interfaces';\n\nexport type PopupPosition = 'above' | 'below';\n\nexport interface BasePopupProperties {\n\t/** Preferred position where the popup should render relative to the provided position (defaults to \"below\"). If the popup does not have room to fully render in the preferred position it will switch to the opposite side. */\n\tposition?: PopupPosition;\n\t/** If the underlay should be visible (defaults to false) */\n\tunderlayVisible?: boolean;\n\t/** Callback triggered when the popup is closed */\n\tonClose?(): void;\n}\n\nexport interface PopupProperties extends BasePopupProperties {\n\t/** The X position on the page where the popup should render */\n\tx: number;\n\t/** The Y position on the page where the bottom of the popup should be if rendering \"above\" */\n\tyBottom: number;\n\t/** The Y position on the page where the popup should start if rendering \"below\" */\n\tyTop: number;\n\t/** Whether the popup is currently open */\n\topen?: boolean;\n}\n\nconst factory = create({ dimensions, theme, bodyScroll })\n\t.properties<PopupProperties>()\n\t.children<RenderResult | undefined>();\n\nexport const Popup = factory(function({\n\tproperties,\n\tchildren,\n\tmiddleware: { dimensions, theme, bodyScroll }\n}) {\n\tconst {\n\t\tunderlayVisible = false,\n\t\tposition = 'below',\n\t\tx,\n\t\tyBottom,\n\t\tyTop,\n\t\tonClose,\n\t\topen\n\t} = properties();\n\n\tconst wrapperDimensions = dimensions.get('wrapper');\n\tconst bottomOfVisibleScreen =\n\t\tdocument.documentElement.scrollTop + document.documentElement.clientHeight;\n\tconst topOfVisibleScreen = document.documentElement.scrollTop;\n\n\tconst willFit = {\n\t\tbelow: yTop + wrapperDimensions.size.height <= bottomOfVisibleScreen,\n\t\tabove: yBottom - wrapperDimensions.size.height >= topOfVisibleScreen\n\t};\n\n\tlet wrapperStyles: Partial<CSSStyleDeclaration> = {\n\t\topacity: '0'\n\t};\n\n\tif (wrapperDimensions.size.height) {\n\t\twrapperStyles = {\n\t\t\tleft: `${x}px`,\n\t\t\topacity: '1'\n\t\t};\n\n\t\tif (position === 'below') {\n\t\t\tif (willFit.below) {\n\t\t\t\twrapperStyles.top = `${yTop}px`;\n\t\t\t} else {\n\t\t\t\twrapperStyles.top = `${yBottom - wrapperDimensions.size.height}px`;\n\t\t\t}\n\t\t} else if (position === 'above') {\n\t\t\tif (willFit.above) {\n\t\t\t\twrapperStyles.top = `${yBottom - wrapperDimensions.size.height}px`;\n\t\t\t} else {\n\t\t\t\twrapperStyles.top = `${yTop}px`;\n\t\t\t}\n\t\t}\n\t}\n\n\tconst classes = theme.classes(css);\n\n\tbodyScroll(!open);\n\n\treturn (\n\t\topen && (\n\t\t\t<body>\n\t\t\t\t<div\n\t\t\t\t\tkey=\"underlay\"\n\t\t\t\t\tclasses={[\n\t\t\t\t\t\ttheme.variant(),\n\t\t\t\t\t\tfixedCss.underlay,\n\t\t\t\t\t\tunderlayVisible && classes.underlayVisible\n\t\t\t\t\t]}\n\t\t\t\t\tonclick={onClose}\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tkey=\"wrapper\"\n\t\t\t\t\tclasses={[theme.variant(), fixedCss.root]}\n\t\t\t\t\tstyles={wrapperStyles}\n\t\t\t\t>\n\t\t\t\t\t{children()}\n\t\t\t\t</div>\n\t\t\t</body>\n\t\t)\n\t);\n});\n\nexport default Popup;\n","import { create, tsx } from '@dojo/framework/core/vdom';\nimport focus from '@dojo/framework/core/middleware/focus';\nimport { RenderResult } from '@dojo/framework/core/interfaces';\nimport Popup from '../popup';\nimport { createICacheMiddleware } from '@dojo/framework/core/middleware/icache';\n\nimport * as css from '../theme/default/context-popup.m.css';\n\nexport interface ContextPopupProperties {\n\tonClose?(): void;\n\tonOpen?(): void;\n}\n\nexport interface ContextPopupChildren {\n\ttrigger: RenderResult;\n\tcontent: (callbacks: { close(): void; shouldFocus(): boolean }) => RenderResult;\n}\n\ninterface ContextIcache {\n\tx: number;\n\ty: number;\n\topen: boolean;\n}\n\nconst icache = createICacheMiddleware<ContextIcache>();\n\nconst factory = create({ icache, focus })\n\t.properties<ContextPopupProperties>()\n\t.children<ContextPopupChildren>();\n\nconst CursorWidth = 2;\nconst CursorHeight = 4;\n\nexport const ContextPopup = factory(function({\n\tproperties,\n\tchildren,\n\tmiddleware: { icache, focus }\n}) {\n\tconst x = icache.getOrSet('x', 0);\n\tconst y = icache.getOrSet('y', 0);\n\n\tconst { trigger, content } = children()[0];\n\tconst close = () => {\n\t\tconst { onClose } = properties();\n\t\ticache.set('open', false);\n\t\tonClose && onClose();\n\t};\n\n\treturn (\n\t\t<virtual>\n\t\t\t<div\n\t\t\t\tclasses={css.trigger}\n\t\t\t\tkey=\"trigger\"\n\t\t\t\toncontextmenu={(event: MouseEvent) => {\n\t\t\t\t\tconst { onOpen } = properties();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tfocus.focus();\n\t\t\t\t\ticache.set('x', event.pageX - CursorWidth);\n\t\t\t\t\ticache.set('y', event.pageY - CursorHeight);\n\t\t\t\t\ticache.set('open', true);\n\t\t\t\t\tonOpen && onOpen();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{trigger}\n\t\t\t</div>\n\t\t\t<Popup\n\t\t\t\tkey=\"popup\"\n\t\t\t\tx={x}\n\t\t\t\tyTop={y}\n\t\t\t\tyBottom={document.documentElement.scrollTop + document.documentElement.clientHeight}\n\t\t\t\tonClose={close}\n\t\t\t\tposition=\"below\"\n\t\t\t\topen={icache.get('open')}\n\t\t\t>\n\t\t\t\t<div>{content({ close, shouldFocus: focus.shouldFocus })}</div>\n\t\t\t</Popup>\n\t\t</virtual>\n\t);\n});\n\nexport default ContextPopup;\n","import { create, destroy } from '@dojo/framework/core/vdom';\nimport global from '@dojo/framework/shim/global';\n\nconst factory = create({ destroy });\nconst bodyStyle = global.document.body.style;\n\nexport const bodyScroll = factory(function bodyScroll({ middleware: { destroy } }) {\n\tlet disabled = false;\n\tlet previousOverflow: string | undefined = undefined;\n\n\tconst enableScroll = () => {\n\t\tif (!disabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (previousOverflow) {\n\t\t\tbodyStyle.setProperty('overflow', previousOverflow);\n\t\t} else {\n\t\t\tbodyStyle.removeProperty('overflow');\n\t\t}\n\t\tdisabled = false;\n\t\tpreviousOverflow = undefined;\n\t};\n\n\tconst disableScroll = () => {\n\t\tif (disabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tdisabled = true;\n\t\tpreviousOverflow = bodyStyle.getPropertyValue('overflow');\n\t\tbodyStyle.setProperty('overflow', 'hidden');\n\t};\n\n\tdestroy(() => {\n\t\tdisabled && enableScroll();\n\t});\n\n\treturn (enable: boolean) => {\n\t\tenable ? enableScroll() : disableScroll();\n\t};\n});\n\nexport default bodyScroll;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"@dojo/widgets/popup\",\"underlayVisible\":\"popup-m__underlayVisible__1Cxv3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"@dojo/widgets/popup\",\"root\":\"popup-m__root__3WJlO\",\"underlay\":\"popup-m__underlay__2CC_p\"};"],"sourceRoot":""}